"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[91,673],{4673:function(e,n,s){s.r(n),s.d(n,{default:function(){return k}});var t=s(885),r=s(2791),a=s(9434),c=s(4410),i=s(7022),l=s(4686),o=s(3504),d=s(9287),u=s(8326),h=s(6183),x=s(7541),m=s(6488),v=s(7371),f=s(3859),p=s(1421),j=s(7580),g=s(6534),N=s(9323),Z=s(184);var k=function(){var e=(0,a.I0)(),n=(0,g.VY)(),s=(0,r.useState)(window.location.pathname),k=(0,t.Z)(s,2),w=k[0],b=k[1],y=function(){e((0,j.TX)()),n.success("Logged out successfully")};return(0,Z.jsx)(c.Z,{expand:"lg",className:" sticky-top  w-100 bg-white  ",children:(0,Z.jsxs)(i.Z,{children:[(0,Z.jsx)(c.Z.Brand,{style:{fontSize:"30px"},children:(0,Z.jsx)(o.rU,{style:{textDecoration:"none",color:"black"},to:"/",children:" Travelista"})}),(0,Z.jsx)(c.Z.Toggle,{"aria-controls":"navbarScroll"}),(0,Z.jsxs)(c.Z.Collapse,{id:"navbarScroll",children:[(0,Z.jsx)(l.Z,{className:"me-auto my-2 my-lg-0",style:{maxHeight:"100px"},navbarScroll:!0}),(0,Z.jsxs)(l.Z,{children:[(0,Z.jsxs)("div",{className:"d-none d-lg-flex",children:[(0,Z.jsx)(o.rU,{to:"/",style:{color:"black",paddingLeft:"22.5px"},onClick:function(){return b("/")},children:"/"===w?(0,Z.jsx)(x.Z,{}):(0,Z.jsx)(h.Z,{})}),(0,Z.jsx)(o.rU,{to:"/search",style:{color:"black",paddingLeft:"22.5px"},onClick:function(){return b("/search")},children:"/search"===w?(0,Z.jsx)(p.Z,{}):(0,Z.jsx)(f.Z,{})}),(0,Z.jsx)(o.rU,{to:"/messenger",style:{color:"black",paddingLeft:"22.5px"},onClick:function(){return b("/messenger")},children:"/messenger"===w?(0,Z.jsx)(u.Z,{}):(0,Z.jsx)(d.Z,{})}),(0,Z.jsxs)(N.Z,{style:{color:"black",paddingLeft:"22.5px",marginTop:"-8px"},title:(0,Z.jsx)(v.Z,{style:{color:"black"}}),id:"basic-nav-dropdown",children:[(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/account",className:"account-text-header",children:"Account"})}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/update/password",className:"account-text-header",children:"Change Password"})}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/update/profile",className:"account-text-header",children:"Edit Profile"})}),(0,Z.jsx)(N.Z.Divider,{}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsxs)("p",{onClick:y,style:{marginBottom:"0"},children:[(0,Z.jsx)(m.Z,{})," LogOut"]})})]})]}),(0,Z.jsx)("div",{className:"d-lg-none d-flex justify-content-start row",children:(0,Z.jsxs)("div",{className:"home-md-icons row",children:[(0,Z.jsx)("div",{className:"each-list-icons dropdown-item",children:(0,Z.jsxs)(o.rU,{to:"/",style:{color:"black",paddingLeft:"22.5px"},className:"icon-in-header",onClick:function(){return b("/")},children:["/"===w?(0,Z.jsx)(x.Z,{}):(0,Z.jsx)(h.Z,{})," Home"]})}),(0,Z.jsx)("div",{className:"each-list-icons dropdown-item",children:(0,Z.jsxs)(o.rU,{to:"/search",style:{color:"black",paddingLeft:"22.5px"},onClick:function(){return b("/search")},className:"icon-in-header",children:["/search"===w?(0,Z.jsx)(p.Z,{}):(0,Z.jsx)(f.Z,{})," Search"]})}),(0,Z.jsx)("div",{className:"each-list-icons dropdown-item",children:(0,Z.jsxs)(o.rU,{to:"/messenger",style:{color:"black",paddingLeft:"22.5px"},onClick:function(){return b("/messenger")},className:"icon-in-header",children:["/messenger"===w?(0,Z.jsx)(u.Z,{}):(0,Z.jsx)(d.Z,{})," Chat"]})}),(0,Z.jsx)("div",{className:"each-list-icons",children:(0,Z.jsxs)(N.Z,{style:{color:"black",paddingLeft:"22.5px",marginTop:"-8px"},title:"Account",id:"basic-nav-dropdown",children:[(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/account",className:"account-text-header",children:"Account"})}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/update/password",className:"account-text-header",children:"Change Password"})}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsx)(o.rU,{to:"/update/profile",className:"account-text-header",children:"Edit Profile"})}),(0,Z.jsx)(N.Z.Divider,{}),(0,Z.jsx)(N.Z.Item,{children:(0,Z.jsxs)("p",{onClick:y,style:{marginBottom:"0"},children:[(0,Z.jsx)(m.Z,{})," LogOut"]})})]})})]})})]})]})]})})}},3091:function(e,n,s){s.r(n),s.d(n,{default:function(){return N}});var t=s(5861),r=s(2982),a=s(885),c=s(7757),i=s.n(c),l=s(2791),o=s(4569),d=s.n(o),u=s(9434),h=s(6256),x=s(184);var m=function(e){var n=e.onlineUsers,s=e.currentId,r=e.setCurrentChat,a=(0,u.v9)((function(e){return e.user})).user,c=function(){var e=(0,t.Z)(i().mark((function e(n){var t,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d().get("/api/v1/conversation/find/".concat(s,"/").concat(n._id));case 3:t=e.sent,a=t.data,r(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n){return e.apply(this,arguments)}}();return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"chatOnline",children:[(0,x.jsx)("p",{className:"text-on-online",children:"Online Users"}),n&&n.length>0?null===n||void 0===n?void 0:n.map((function(e){return(0,x.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return c(e)},children:[(0,x.jsxs)("div",{className:"chatOnlineImgContainer",children:[(0,x.jsx)("img",{className:"chatOnlineImg",src:null===e||void 0===e?void 0:e.avatar.url,alt:"online friend avatar"}),(0,x.jsx)("div",{className:"chatOnlineBadge"})]}),(0,x.jsx)("span",{className:"chatOnlineName",children:null===e||void 0===e?void 0:e.name})]},e._id)})):(0,x.jsxs)("p",{style:{color:"rgb(118, 118, 124)"},children:[(0,x.jsx)(h.Z,{})," ",(0,x.jsx)("span",{className:"no-one-online",children:"Oops.. everyone is having a break time!"})," "]})]}),(0,x.jsx)("div",{children:(0,x.jsxs)("div",{className:"chatOnline",children:[(0,x.jsx)("p",{className:"text-on-online mt-2",children:"Friends list"}),a&&a.following.length>0?a.following.map((function(e){return(0,x.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return c(e)},children:[(0,x.jsx)("div",{className:"chatOnlineImgContainer",children:(0,x.jsx)("img",{className:"chatOnlineImg",src:e.avatar.url,alt:""})}),(0,x.jsx)("span",{className:"chatOnlineName",children:e.name})]})})):(0,x.jsx)("p",{style:{margin:"2vmax"},children:" You're not following anyone"})]})})]})};var v=function(e){var n=e.conversation,s=e.currentUser,r=(0,l.useState)(null),c=(0,a.Z)(r,2),o=c[0],u=c[1];return(0,l.useEffect)((function(){var e=n.members.find((function(e){return e!==s._id})),r=function(){var n=(0,t.Z)(i().mark((function n(){var s,t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,d()("/api/v1/user/".concat(e));case 3:s=n.sent,t=s.data,u(t.user),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();r()}),[s,n]),(0,x.jsxs)("div",{className:"conversation",children:[(0,x.jsx)("img",{className:"conversationImg",src:o&&o.avatar.url,alt:""}),(0,x.jsx)("span",{className:"conversationName",children:o&&o.name})]})},f=s(6314);var p=function(e){var n=e.message,s=e.own;return(0,x.jsxs)("div",{className:s?"message own":"message",children:[(0,x.jsxs)("div",{className:"messageTop",children:[(0,x.jsx)("img",{className:"messageImg",src:null===n||void 0===n?void 0:n.sender.avatar.url,alt:""}),(0,x.jsx)("p",{className:"messageText",children:n.text})]}),(0,x.jsx)("div",{className:"messageBottom",children:(0,f.WU)(n.createdAt)})]})},j=s(9609),g=s(4673);var N=function(){var e=(0,l.useState)([]),n=(0,a.Z)(e,2),s=n[0],c=n[1],o=(0,l.useState)(null),h=(0,a.Z)(o,2),f=h[0],N=h[1],Z=(0,l.useState)([]),k=(0,a.Z)(Z,2),w=k[0],b=k[1],y=(0,l.useState)(""),C=(0,a.Z)(y,2),I=C[0],U=C[1],O=(0,l.useState)(null),_=(0,a.Z)(O,2),S=_[0],B=_[1],L=(0,l.useState)(null),E=(0,a.Z)(L,2),T=E[0],F=E[1],A=(0,l.useRef)((0,j.io)("https://trvalista.online")),D=(0,l.useRef)(),M=(0,u.v9)((function(e){return e.user})).user;(0,l.useEffect)((function(){return A.current=(0,j.io)("https://travalista.online"),A.current.on("getMessage",(function(e){B({sender:e.sender,text:e.text,createdAt:Date.now()})})),function(){A.current.close()}}),[A]),(0,l.useEffect)((function(){S&&(null===f||void 0===f?void 0:f.members.includes(S.sender._id))&&b((function(e){return[].concat((0,r.Z)(e),[S])}))}),[S,f]),(0,l.useEffect)((function(){A.current.emit("addUser",M._id),A.current.on("getUsers",(function(e){e=JSON.parse(e),F(M.following.filter((function(n){return e.some((function(e){return e.userId===n._id}))})))}))}),[M.following,M._id]),(0,l.useEffect)((function(){var e=function(){var e=(0,t.Z)(i().mark((function e(){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d().get("/api/v1/conversation/".concat(M._id));case 3:n=e.sent,s=n.data,c(s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[M._id]),(0,l.useEffect)((function(){var e=function(){var e=(0,t.Z)(i().mark((function e(){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d().get("/api/v1/message/".concat(null===f||void 0===f?void 0:f._id));case 3:n=e.sent,s=n.data,b(s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[f]);var P=function(){var e=(0,t.Z)(i().mark((function e(n){var s,t,a,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),s={sender:M,text:I,conversationId:f._id},t=f.members.find((function(e){return e!==M._id})),A.current.emit("sendMessage",{senderId:{avatar:M.avatar,_id:M._id},receiverId:t,text:I}),e.prev=4,e.next=7,d().post("/api/v1/message",s);case 7:a=e.sent,c=a.data,b([].concat((0,r.Z)(w),[c])),U(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(n){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){var e;null===(e=D.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[w]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(g.default,{}),(0,x.jsx)("div",{className:"body-messager pt-2 ",children:(0,x.jsxs)("div",{className:"messenger  container",children:[(0,x.jsx)("div",{className:"chatMenu d-none d-sm-block col-2",children:(0,x.jsxs)("div",{className:"chatMenuWrapper",children:[(0,x.jsx)("h5",{children:"Recent Chats"}),s.map((function(e){return(0,x.jsx)("div",{onClick:function(){return N(e)},children:(0,x.jsx)(v,{conversation:e,currentUser:M})},e._id)}))]})}),(0,x.jsx)("div",{className:"chatBox col-sm-8",children:(0,x.jsx)("div",{className:"chatBoxWrapper",children:f?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"chatBoxTop",children:w.map((function(e){return(0,x.jsx)("div",{ref:D,children:(0,x.jsx)(p,{message:e,own:e.sender._id===M._id})},e._id)}))}),(0,x.jsxs)("div",{className:"chatBoxBottom",children:[(0,x.jsx)("input",{type:"text",className:"chatMessageInput",placeholder:"write something...",onChange:function(e){return U(e.target.value)},value:I,onKeyPress:function(e){"Enter"===e.key&&P(e)}}),I.length<1?(0,x.jsx)("button",{className:"chatSubmitButton",children:"Send"}):(0,x.jsx)("button",{className:"chatSubmitButton",onClick:P,children:"Send"})]})]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("p",{className:"noConversationText",children:"Open a conversation to start a chat."})})})}),(0,x.jsx)("div",{className:"chatOnline col-4 col-sm-2",children:(0,x.jsx)("div",{className:"chatOnlineWrapper",children:(0,x.jsx)(m,{onlineUsers:T&&T,currentId:M._id,setCurrentChat:N})})})]})})]})}}}]);
//# sourceMappingURL=91.2182360d.chunk.js.map